<div class="view-wrapper list-page">
  <div *ngIf="isParamsOpend" class="paramsDiv">
    <div *ngIf="isParamsOpend">
      <dx-form>
        <dxi-item
          itemType="group"
          cssClass="form-group"
          class="rowGroup"
          [colCount]="8"
          [colCountByScreen]="{ xs: 8, sm: 8, md: 8, lg: 8 }"
        >
          <dxi-item [colSpan]="8">
            <div class="">
              <dx-tag-box
                labelMode="floating"
                labelLocation="left"
                label="Select Facility value"
                [(value)]="Facility_Value"
                valueExpr="ID"
                displayExpr="Name"
                [showClearButton]="false"
                [multiline]="false"
                [searchEnabled]="true"
                [searchExpr]="['Name', 'Code']"
                [dataSource]="Facility_DataSource"
                [showSelectionControls]="true"
                [applyValueMode]="'instantly'"
                (onValueChanged)="onDropDownBoxValueChanged()"
                [dropDownOptions]="{ width: 'auto' }"
              >
              </dx-tag-box>
            </div>
          </dxi-item>
        </dxi-item>

        <dxi-item
          itemType="group"
          cssClass="form-group"
          [colCount]="8"
          [colCountByScreen]="{ xs: 8, sm: 8, md: 8, lg: 8 }"
        >
          <dxi-item [colSpan]="2">
            <div>
              <dx-select-box
                labelMode="floating"
                labelLocation="left"
                label="select searchOn value"
                [dataSource]="SearchOn_DataSource"
                displayExpr="Name"
                valueExpr="ID"
                [(value)]="SearchOn_Value"
                [searchEnabled]="true"
                (valueChanged)="onDropdownValueChanged()"
                [dropDownOptions]="{ width: 'auto' }"
              >
              </dx-select-box>
            </div>
          </dxi-item>

          <dxi-item [colSpan]="1">
            <dx-select-box
              labelMode="floating"
              labelLocation="left"
              label="select Year"
              [(value)]="selectedYear"
              [dataSource]="years"
              (onValueChanged)="onYearChanged($event)"
              placeholder="Year"
              [width]="'auto'"
            ></dx-select-box>
          </dxi-item>

          <dxi-item [colSpan]="1">
            <div>
              <dx-select-box
                labelMode="floating"
                labelLocation="left"
                label="select month"
                [dataSource]="monthDataSource"
                displayExpr="name"
                valueExpr="value"
                [(value)]="selectedmonth"
                (onValueChanged)="onMonthValueChanged($event)"
                [dropDownOptions]="{ width: 'auto' }"
              >
              </dx-select-box>
            </div>
          </dxi-item>

          <dxi-item [colSpan]="1">
            <dx-date-box
              labelMode="floating"
              labelLocation="left"
              label="From Date"
              type="date"
              displayFormat="dd/MM/yyyy"
              valueFormat="yyyy/MM/dd"
              [(value)]="From_Date_Value"
              [min]="minDate"
              [max]="maxDate"
            >
            </dx-date-box>
          </dxi-item>

          <dxi-item [colSpan]="1">
            <dx-date-box
              labelMode="floating"
              labelLocation="left"
              label="To Date"
              type="date"
              displayFormat="dd/MM/yyyy"
              valueFormat="yyyy/MM/dd"
              [(value)]="To_Date_Value"
              [min]="minDate"
              [max]="maxDate"
            >
            </dx-date-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <div>
              <dx-select-box
                labelMode="floating"
                labelLocation="left"
                label="select encounter type"
                [dataSource]="EncounterType_DataSource"
                displayExpr="Name"
                valueExpr="ID"
                [(value)]="EncounterType_Value"
                [searchEnabled]="true"
                (valueChanged)="onDropdownValueChanged()"
              >
              </dx-select-box>
            </div>
          </dxi-item>
        </dxi-item>

        <dxi-item
          itemType="group"
          cssClass="form-group"
          [colCount]="8"
          [colCountByScreen]="{ xs: 8, sm: 8, md: 8, lg: 8 }"
        >
          <dxi-item [colSpan]="2">
            <dx-tag-box
              labelMode="floating"
              labelLocation="left"
              label="select payer"
              [dataSource]="Payer_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="Payer_Value"
              [searchEnabled]="true"
              [searchExpr]="['Name', 'ID']"
              [multiline]="false"
              [applyValueMode]="'instantly'"
              [showSelectionControls]="true"
              (valueChanged)="onDropdownValueChanged()"
            >
            </dx-tag-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <dx-tag-box
              labelMode="floating"
              labelLocation="left"
              label="select payer ID"
              [dataSource]="PayerID_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="PayerID_Value"
              [searchEnabled]="true"
              [searchExpr]="['Name', 'ID']"
              [multiline]="false"
              [applyValueMode]="'instantly'"
              [showSelectionControls]="true"
              (valueChanged)="onDropdownValueChanged()"
              [dropDownOptions]="{ width: 'auto' }"
            >
            </dx-tag-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <dx-tag-box
              labelMode="floating"
              labelLocation="left"
              label="select clinician"
              [dataSource]="Clinician_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="Clinician_Value"
              [searchEnabled]="true"
              [searchExpr]="['Name', 'ID']"
              [multiline]="false"
              [applyValueMode]="'instantly'"
              [showSelectionControls]="true"
              (valueChanged)="onDropdownValueChanged()"
              [dropDownOptions]="{ width: 'auto' }"
            >
            </dx-tag-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <dx-tag-box
              labelMode="floating"
              labelLocation="left"
              label="select ordering clinician"
              [dataSource]="OrderingClinician_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="OrderingClinician_Value"
              [searchEnabled]="true"
              [searchExpr]="['Name', 'ID']"
              [multiline]="false"
              [applyValueMode]="'instantly'"
              [showSelectionControls]="true"
              (valueChanged)="onDropdownValueChanged()"
              [dropDownOptions]="{ width: 'auto' }"
            >
            </dx-tag-box>
          </dxi-item>
        </dxi-item>

        <dxi-item
          itemType="group"
          cssClass="form-group"
          [colCount]="8"
          [colCountByScreen]="{ xs: 8, sm: 8, md: 8, lg: 8 }"
        >
          <dxi-item [colSpan]="2">
            <dx-tag-box
              labelMode="floating"
              labelLocation="left"
              label="Select Reciever ID"
              [dataSource]="RecieverID_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="ReceiverID_Value"
              [searchEnabled]="true"
              [searchExpr]="['Name', 'ID']"
              [multiline]="false"
              [applyValueMode]="'instantly'"
              [showSelectionControls]="true"
              [dropDownOptions]="{ width: 'auto' }"
              (valueChanged)="onDropdownValueChanged()"
            >
            </dx-tag-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <div>
              <dx-text-box
                labelMode="floating"
                labelLocation="left"
                label="Enter Claim Number"
                [(value)]="ClaimNumber_Value"
              >
              </dx-text-box>
            </div>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <div>
              <dx-text-box
                labelMode="floating"
                labelLocation="left"
                label="Enter Patient ID"
                [(value)]="PatientID_Value"
              >
              </dx-text-box>
            </div>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <div>
              <dx-text-box
                labelMode="floating"
                labelLocation="left"
                label="Enter Member ID"
                [(value)]="memberID_Value"
              >
              </dx-text-box>
            </div>
          </dxi-item>
        </dxi-item>

        <dxi-item
          itemType="group"
          cssClass="form-group"
          [colCount]="8"
          [colCountByScreen]="{ xs: 8, sm: 8, md: 8, lg: 8 }"
        >
          <dxi-item [colSpan]="2">
            <dx-select-box
              labelMode="floating"
              labelLocation="left"
              label="Select Resubmission Type"
              [dataSource]="ResubmissionType_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="Resubmission_Value"
              [searchEnabled]="true"
              (valueChanged)="onDropdownValueChanged()"
            >
            </dx-select-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <div>
              <dx-tag-box
                labelMode="floating"
                labelLocation="left"
                label="select Denial Codes"
                [dataSource]="DenialCodes_DataSource"
                displayExpr="Name"
                valueExpr="ID"
                [(value)]="DenialCodes_Value"
                [searchEnabled]="true"
                [searchExpr]="['Name', 'ID']"
                [multiline]="false"
                [applyValueMode]="'instantly'"
                [showSelectionControls]="true"
                (valueChanged)="onDropdownValueChanged()"
                [dropDownOptions]="{ width: 'auto' }"
              >
              </dx-tag-box>
            </div>
          </dxi-item>
        </dxi-item>

        <dxi-item
          itemType="group"
          cssClass="form-group"
          [colCount]="6"
          [colCountByScreen]="{ xs: 6, sm: 6, md: 6, lg: 6 }"
        >
          <dxi-item [colSpan]="2">
            <dx-tag-box
              labelMode="floating"
              labelLocation="left"
              label="Select Claim Status"
              [dataSource]="CliamStatus_DataSource"
              displayExpr="Name"
              valueExpr="ID"
              [(value)]="CliamStatus_Value"
              [searchEnabled]="true"
              [searchExpr]="['Name', 'ID']"
              [multiline]="false"
              [applyValueMode]="'instantly'"
              [showSelectionControls]="true"
              [dropDownOptions]="{ width: 'auto' }"
              (valueChanged)="onDropdownValueChanged()"
            >
            </dx-tag-box>
          </dxi-item>

          <dxi-item [colSpan]="2">
            <div>
              <dx-select-box
                labelMode="floating"
                labelLocation="left"
                label="select Payment Status"
                [dataSource]="paymentStatus_DataSource"
                displayExpr="Name"
                valueExpr="ID"
                [(value)]="paymentStatus_Value"
                [searchEnabled]="true"
                (valueChanged)="onDropdownValueChanged()"
              >
              </dx-select-box>
            </div>
          </dxi-item>

          <dxi-item [colSpan]="1" class="mt-1 ms-5">
            <dx-button
              class="add-card"
              icon="download"
              text=""
              hint="import search parameters from your excel"
              type="default"
              stylingMode="contained"
              (onClick)="get_advance_Filter()"
            >
            </dx-button>
          </dxi-item>

          <dxi-item [colSpan]="1" class="mt-1">
            <dx-button
              class="add-card"
              icon="todo"
              text="Apply"
              type="default"
              stylingMode="contained"
              (onClick)="get_Datagrid_DataSource()"
            >
            </dx-button>
          </dxi-item>
        </dxi-item>
      </dx-form>
    </div>
  </div>

  <!-- ====================================Data GRid Table started================================ -->
  <ng-container>
    <dx-data-grid
      #dataGrid
      id="main-grid"
      class="grid reportGrid"
      [height]="'100vh'"
      noDataText="no data"
      [dataSource]="dataGrid_DataSource"
      [showBorders]="true"
      [allowColumnResizing]="true"
      [columnAutoWidth]="true"
      [allowColumnReordering]="true"
      [columnFixing]="{
        enabled: true,
        texts: { fix: 'Freeze', unfix: 'Unfreeze' }
      }"
      (onExporting)="onExporting($event)"
      [filterRow]="{ visible: false }"
      [headerFilter]="{ visible: false }"
    >
      <dxi-column
        *ngFor="let column of columnsConfig"
        [dataField]="column.dataField"
        [caption]="column.caption"
        [format]="column.format"
        [visible]="column.visible"
        [width]="200"
      ></dxi-column>

      <dxo-search-panel [visible]="true"></dxo-search-panel>
      <dxo-paging *ngIf="show_Pagination" [pageSize]="10"></dxo-paging>
      <dxo-pager
        *ngIf="show_Pagination"
        [visible]="true"
        [allowedPageSizes]="allowedPageSizes"
        [displayMode]="displayMode"
        [showPageSizeSelector]="showPageSizeSelector"
        [showInfo]="showInfo"
        [showNavigationButtons]="showNavButtons"
      >
      </dxo-pager>
      <dxo-load-panel [showPane]="false"></dxo-load-panel>
      <dxo-scrolling mode="virtual"></dxo-scrolling>
      <dxo-sorting mode="multiple"></dxo-sorting>
      <dxo-header-filter [visible]="true" highlight="true"></dxo-header-filter>

      <dxo-column-chooser [height]="500" [enabled]="true" mode="select">
      </dxo-column-chooser>

      <dxo-search-panel
        [visible]="true"
        placeholder="Search"
      ></dxo-search-panel>

      <dxo-filter-row
        [visible]="isFilterOpened"
        [applyFilter]="applyFilter"
      ></dxo-filter-row>
      <dxo-export
        [enabled]="true"
        [allowExportSelectedData]="true"
        [formats]="['xlsx']"
      >
      </dxo-export>
      <dxo-toolbar>
        <dxi-item location="before">
          <div class="grid-header">Claim Details with Action</div>
        </dxi-item>
        <dxi-item
          widget="dxButton"
          [options]="{
            text: '',
            icon: 'filter',
            onClick: show_Parameter_Div,
            hint: hint_for_Parametr_div
          }"
        ></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item
          location="after"
          locateInMenu="auto"
          showText="inMenu"
          widget="dxButton"
          [options]="{
            text: 'Refresh',
            icon: 'refresh',
            onClick: refresh,
            stylingMode: 'text',
            disabled: !isDatagridLoaded,
            hint: 'Refresh'
          }"
        ></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item
          widget="dxButton"
          [options]="{
            text: '',
            icon: 'find',
            onClick: filterClick,
            disabled: !isDatagridLoaded,
            hint: 'Search Column'
          }"
        ></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item
          name="columnChooserButton"
          locateInMenu="auto"
          [disabled]="!isDatagridLoaded"
        ></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item
          widget="dxButton"
          [options]="{
            text: '',
            icon: 'formula',
            onClick: SummaryClick,
            hint: 'Hide/Show Summary',
            disabled: !isDatagridLoaded,
          }"
        ></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item name="exportButton"></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item
            widget="dxButton"
            [options]="{
              text: '',
              icon: 'newfolder',
              onClick: show_Memorise_popup,
              hint: 'Save Memorize Report'
            }"
          ></dxi-item>
        <dxi-item location="after" locateInMenu="auto">
          <div class="separator"></div>
        </dxi-item>
        <dxi-item
          widget="dxSelectBox"
          [options]="{
            text: '',
            dataSource:memorise_Dropdown_DataList,
            displayExpr:'name',
            valueExpr:'name',
            icon: 'datafield',
            hint: 'Show Memorise Report',
            noDataText: 'load data and try again',
            selectable: true,
            disabled: !isDatagridLoaded,
            placeholder:'memorise report',
            onValueChanged:ShowMemoriseTable,
            dropDownOptions:{
              width: 'auto',
            }
          }"
        ></dxi-item>
        <dxi-item
          class="columnfinderclass"
          widget="dxSelectBox"
          [options]="{
            dataSource: ColumnNames,
            searchEnabled: true,
            onValueChanged: findColumnLocation,
            placeholder: 'Search Column',
            noDataText: 'load data and try again',
            showDropDownButton: true,
            disabled: !isDatagridLoaded,
            hint: 'Column location finder',
            dropDownOptions: {
              width: 'auto',
            }
          }"
        >
        </dxi-item>
      </dxo-toolbar>

      <dxo-grouping
        [autoExpandAll]="false"
        [contextMenuEnabled]="true"
        [expandMode]="'rowClick'"
      ></dxo-grouping>

      <dxo-selection mode="multiple"></dxo-selection>
      <dxo-header-filter [visible]="true"></dxo-header-filter>
      <dxo-summary class="mainSummaryDiv" summaryText="Total">
        <!-- ==========================Group item Summary===================== -->
        <dxi-group-item
          column="Quantity"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="NetAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="InitialNetAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="RemittedAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="LastRemittedAmount"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="InitialRejectedAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="RejectedAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="UnprocessedAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="RejectionPercentage"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="WriteOffAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>
        <dxi-group-item
          column="SettledAmt"
          summaryType="sum"
          displayFormat="{0}"
          [customizeText]="customiseTotal"
          [alignByColumn]="true"
          [showInGroupFooter]="false"
        >
        </dxi-group-item>

        <!-- ==========================Grand Total Summary==================== -->
        <ng-container visible="isSummaryOpened" class="totalsummaryDiv">
          <dxi-total-item
            column="Quantity"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="NetAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="InitialNetAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="RemittedAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="LastRemittedAmount"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="InitialRejectedAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="RejectedAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="UnprocessedAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="RejectionPercentage"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="WriteOffAmt"
            summaryType="sum"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>
          <dxi-total-item
            column="SettledAmt"
            summaryType="sum"
            [customizeText]="customiseTotal"
            displayFormat="{0}"
            [customizeText]="customiseTotal"
          >
          </dxi-total-item>

          <dxi-total-item
            column="CPTType"
            summaryType="count"
            [customizeText]="customiseCountText"
          >
          </dxi-total-item>
        </ng-container>
      </dxo-summary>
    </dx-data-grid>
  </ng-container>


  <dx-popup
  [(visible)]="isSaveMemorisedOpened"
  [title]="'Memorise Report'"
  [width]="350"
  height="60vh"
>
  <dx-form id="form">
    <dxi-item itemType="group" cssClass="form-group" [colCount]="1">
      <dxi-item itemType="group">
        <dxi-item
          dataField="MemoriseReportName"
          caption="Memorise Report Name"
          [editorOptions]="{
            placeholder: 'Enter Memorise Name',
            value: MemoriseReportName,
            onValueChanged: onMemoriseReportNameChanged.bind(this)
          }"
          [label]="{
            text: 'Memorise Report Name',
            visible: true,
            location: 'top',
            alignment: 'left',
            showColon: false,
            showRequiredMark: false,
            textStyle: { fontWeight: 'bold' }
          }"
        >
        </dxi-item>
      </dxi-item>
    </dxi-item>
  </dx-form>
  <dx-button
    text="Save"
    type="default"
    (onClick)="save_Memorise_Report()"
    class="save-button"
  ></dx-button>
</dx-popup>

  <form-popup
    class="formPopupClass hide-buttons dx-popup-content"
    [(visible)]="isAdvancefilterOpened"
    titleText="Advance filter"
    height="80vh"
    [width]="350"
    [width]="filterpopupWidth"
    [visibleButtons]="true"
    saveButtonText="Apply"
    (save)="import_Advance_Filter()"
  >
    <app-advance-filter-popup
      [columnData]="advanceFilterGridColumns"
    ></app-advance-filter-popup>
  </form-popup>
</div>
